<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ø­Ù„ Ø§Ù„Ø¥Ø®ÙˆØ© Ù…Ø²ÙˆØ§Ø±</title>

{% load static %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body>

<!-- ===== HERO SECTION ===== -->
<div class="hero">

    <!-- Logo -->
    <img src="{% static 'images/logo.png' %}" class="hero-logo">

    <h1>ğŸ¥•ğŸ Ù…Ø­Ù„ Ø§Ù„Ø¥Ø®ÙˆØ© Ù…Ø²ÙˆØ§Ø±</h1>
    <p>Ø®Ø¶Ø± ÙˆÙÙˆØ§ÙƒÙ‡ Ø·Ø§Ø²Ø¬Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ Ø¨Ø§Ø¨ Ù…Ù†Ø²Ù„Ùƒ</p>

    <a href="#shop" class="start-btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù† ğŸ›’</a>

    <div class="down-arrow">â¬‡</div>
</div>

<!-- ===== SLIDER SECTION ===== -->
<div class="slider">

    <div class="slides">
        <img src="{% static 'images/slide_welcome.PNG' %}">
        <img src="{% static 'images/slide1.PNG' %}">
        <img src="{% static 'images/slide2.PNG' %}">
        <img src="{% static 'images/slide3.PNG' %}">
    </div>

</div>

<!-- ===== SEARCH ===== -->
<div id="shop" class="search-box">
    <form method="get" style="display:flex;width:100%;">
        <input type="text" name="q" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªÙˆØ¬...">
        <button type="submit">ğŸ”</button>
    </form>
</div>


<div class="container">

{% regroup products by category as category_list %}

{% for cat in category_list %}

    <div class="category-title">
        ğŸ¥¬ {{ cat.grouper.name }}
    </div>

    <div class="products">

    {% for product in cat.list %}

    <form method="post" action="{% url 'cart_add' product.id %}">
    {% csrf_token %}

    <div class="card">

        <img src="{{ product.image.url }}">

        <div class="content">
            <h3>{{ product.name }}</h3>

            <div class="price">
                {{ product.price }} Ø¯Ø¬ /
                {% if product.sell_unit == 'kg' %}ÙƒØº{% else %}Ù‚Ø·Ø¹Ø©{% endif %}
            </div>

            <!-- Quantity -->
            <div class="qty-box" data-step="{{ product.step }}">
                <button type="button" onclick="changeQty(this,-1)">âˆ’</button>

                <input
                    type="number"
                    name="quantity"
                    value="{{ product.step }}"
                    step="{{ product.step }}"
                    min="{{ product.step }}"
                >

                <button type="button" onclick="changeQty(this,1)">+</button>
            </div>

            <button type="submit" class="add-btn">
                ğŸ›’ Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©
            </button>

        </div>
    </div>

    </form>

    {% endfor %}

    </div>

{% endfor %}

</div>


<a href="{% url 'cart_detail' %}" class="cart-btn">
ğŸ›’ Ø§Ù„Ø³Ù„Ø©
</a>


<script>
function changeQty(btn, direction) {
    const box = btn.closest(".qty-box");
    const input = box.querySelector("input");
    const step = parseFloat(box.dataset.step);

    let value = parseFloat(input.value);
    value += step * direction;

    if(value < step) value = step;

    input.value = value.toFixed(1);
}
</script>

</body>
</html>